{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","js/flashVPAID.js","js/IVPAID.js","js/utils.js"],"names":[],"mappings":"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","file":"flashVPAID.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","//if this code already run once don't do anything\n(function () {\nif (window.FlashVPAID) return;\n\nlet IVPAID = require('./IVPAID').IVPAID;\nlet noop = require('./utils').noop;\nlet unique = require('./utils').unique;\nlet uniqueVPAID = unique('vpaid');\nlet instances = {};\nconst VPAID_FLASH_HANDLER = 'vpaid_video_flash_handler';\n\nfunction createElementWithID(parent, id) {\n    var nEl = document.createElement('div');\n    nEl.id = id;\n    parent.innerHTML = '';\n    parent.appendChild(nEl);\n    return nEl;\n}\n\nclass FlashVPAID extends IVPAID {\n    constructor (vpaidWrapper, callback, swfConfig = {data: 'VPAIDFlash.swf', width: 800, height: 400}, version = '9', params = { wmode: 'transparent', salign: 'tl', allowScriptAccess: 'always'}, debug = false) {\n        super();\n        this._handlers = {};\n        this._callbacks = {};\n\n        this.vpaidWrapper = vpaidWrapper;\n        this.flashID = uniqueVPAID();\n        this.load =  callback || noop;\n        this._uniqueMethodIdentifier = unique(this.flashID);\n        createElementWithID(vpaidWrapper, this.flashID);\n\n        //because flash externalInterface will call\n        instances[this.flashID] = this;\n\n        params.movie = swfConfig.data;\n        params.FlashVars = `flashid=${this.flashID}&handler=${VPAID_FLASH_HANDLER}&debug=${debug}`;\n\n        if (swfobject.hasFlashPlayerVersion(version)) {\n            this.el = swfobject.createSWF(swfConfig, params, this.flashID);\n        }\n\n        //if this.el is undefined means swfobject failed to create the swfobject\n        if (!this.el) return this;\n    }\n\n    _safeFlashMethod(methodName, args = [], callbacks = undefined) {\n        var callbackID = '';\n        // if no callback, some methods the return is void so they don't need callback\n        if (callback) {\n            var callbackID = this.uniqueMethodIdentifier();\n            this._callbacks[callbackID] = callback;\n        }\n\n        try {\n            this.el[methodName].call(this, [this.flashID, methodName, callbackID].concat(args));\n\n        } catch (e) {\n            if (callback) {\n                delete this.callback[callbackID];\n                callback(e);\n            } else {\n\n                //if there isn't any callback to return error use error event handler\n                _fireEvent('error', [e]);\n            }\n        }\n    }\n\n    _flashMethodAnswer(methodName, callbackID, args) {\n\n        //method's that return void will not have callbacks\n        if (callbackID === '') return;\n\n        if (!this._callbacks[callbackID]) {\n            //TODO: something is wrong, this should never happens if it happens fire an error\n            return;\n        }\n\n        //TODO: check with carlos if we need to use apply instead\n        this._callbacks[callbackID](args);\n        delete this._callbacks[callbackID];\n    }\n\n    _fireEvent(eventName, args) {\n        //TODO: check if forEach and isArray is added to the browser with babeljs\n        if (Array.isArray(this._handlers[eventName])) {\n            this._handlers[eventName].forEach(function (callback) {\n                setTimeout(function () {\n                    callback(args);\n                }, 0);\n            });\n        }\n    }\n\n    on(eventName, callback) {\n        if (!this._handlers[eventName]) {\n            this._handlers[eventName] = [];\n        }\n        this._handlers[eventName].push(callback);\n    }\n\n    //async methods\n    handshakeVersion(callback, playerVPAIDVersion = '2.0') {\n        _safeFlashMethod('handshakeVersion', [playerVPAIDVersion], callback);\n    }\n\n    initAd (viewMode, desiredBitrate, width = 0, height = 0, creativeData = '', environmentVars = '') {\n        this.size(width, height);\n        _safeFlashMethod('initAd', [this.getWidth(), this.getHeight(), viewMode, desiredBitrate, creativeData, environmentVars]);\n    }\n\n    resizeAd(width, height, viewMode) {\n        this.size(width, height);\n        _safeFlashMethod('resizeAd', [this.getWidth(), this.getHeight(), viewMode]);\n    }\n\n    startAd() {\n        _safeFlashMethod('startAd');\n    }\n    stopAd() {\n        _safeFlashMethod('stopAd');\n    }\n    pauseAd() {\n        _safeFlashMethod('pauseAd');\n    }\n    resumeAd() {\n        _safeFlashMethod('resumeAd');\n    }\n    expandAd() {\n        _safeFlashMethod('expandAd');\n    }\n    collapseAd() {\n        _safeFlashMethod('collapseAd');\n    }\n    skipAd() {\n        _safeFlashMethod('skipAd');\n    }\n\n    //properties that will be treat as async methods\n    adLinear(callback) {\n        _safeFlashMethod('adLinear', [], callback);\n    }\n    adWidth(callback) {\n        _safeFlashMethod('adWidth', [], callback);\n    }\n    adHeight(callback) {\n        _safeFlashMethod('adHeight', [], callback);\n    }\n    adExpanded(callback) {\n        _safeFlashMethod('adExpanded', [], callback);\n    }\n    adSkippableState(callback) {\n        _safeFlashMethod('adSkippableState', [], callback);\n    }\n    adRemainingTime(callback) {\n        _safeFlashMethod('adRemainingTime', [], callback);\n    }\n    adDuration(callback) {\n        _safeFlashMethod('adDuration', [], callback);\n    }\n    //TODO: in flash we need to convert setAdVolume to a setter\n    setAdVolume(volume) {\n        _safeFlashMethod('setAdVolume', [volume]);\n    }\n    //TODO: in flash we need to convert getAdVolume to a getter\n    getAdVolume(callback) {\n        _safeFlashMethod('getAdVolume', [], callback);\n    }\n    adCompanions(callback) {\n        _safeFlashMethod('adCompanions', [], callback);\n    }\n    adIcons(callback) {\n        _safeFlashMethod('adIcons', [], callback);\n    }\n\n    _flash_handShake (message) {\n        console.log('handShake:', message);\n        if (message == 'prepared') {\n            this.load();\n        }\n    }\n\n}\n\nwindow[VPAID_FLASH_HANDLER] = function (flashID, event, message) {\n    console.log('flashID', flashID, 'event', event, 'message', message);\n    //console.log(instances[flashID], instances[flashID]['_flash_']);\n    instances[flashID]['_flash_' + event](message);\n}\nwindow.FlashVPAID = FlashVPAID;\n\n})();\n\n","//simple representation of the API\nexport class IVPAID {\n\n    //custom implementation, sync methods\n    getWidth() {}\n    setWidth(w) {}\n\n    getHeight() {}\n    setHeight(h) {}\n\n    getSize() {}\n    setSize(width, height) {}\n\n\n    //all methods below\n    //are async methods\n    handshakeVersion(callback, playerVPAIDVersion = '2.0') {}\n\n    //width and height is not in the beginning because we will use the default width/height used in the constructor\n    initAd ( viewMode : String, desiredBitrate : Number, width = 0, height = 0, creativeData = '', environmentVars = '') {}\n    resizeAd(width, height, viewMode) {}\n\n    startAd() {}\n    stopAd() {}\n    pauseAd() {}\n    resumeAd() {}\n    expandAd() {}\n    collapseAd() {}\n    skipAd() {}\n\n    //properties that will be treat as async methods\n    adLinear() {}\n    adWidth() {}\n    adHeight() {}\n    adExpanded() {}\n    adSkippableState() {}\n    adRemainingTime() {}\n    adDuration() {}\n    setAdVolume(soundVolume) {}\n    getAdVolume() {}\n    adCompanions() {}\n    adIcons() {}\n}\n\n/*\nEvents that can be subscribed\nAdLoaded\nAdStarted\nAdStopped\nAdSkipped\nAdSkippableStateChange\nAdSizeChange\nAdLinearChange\nAdDurationChange\nAdExpandedChange\nAdRemainingTimeChange [Deprecated in 2.0] but will be still fired for backwards compatibility\nAdVolumeChange\nAdImpression\nAdVideoStart, AdVideoFirstQuartile, AdVideoMidpoint, AdVideoThirdQuartile,\nAdVideoComplete\nAdClickThru\nAdInteraction\nAdUserAcceptInvitation, AdUserMinimize, AdUserClose\nAdPaused, AdPlaying\nAdLog\nAdError\n*/\n\n","\nexport function unique(prefix) {\n    let count = -1;\n    return f => {\n        return `${prefix}_${++count}`;\n    };\n}\n\nexport function noop() {\n}\n\n"]}